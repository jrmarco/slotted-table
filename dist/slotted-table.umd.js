(function(e,N){typeof exports=="object"&&typeof module<"u"?module.exports=N(require("vue")):typeof define=="function"&&define.amd?define(["vue"],N):(e=typeof globalThis<"u"?globalThis:e||self,e.SlottedTable=N(e.Vue))})(this,function(e){"use strict";var N=document.createElement("style");N.textContent=`.slottedtable[data-v-7b719e9c]{width:100%;border-collapse:collapse}.slottedtable .st-header[data-v-7b719e9c],.slottedtable .st-body[data-v-7b719e9c]{display:table;width:100%}.slottedtable .st-row[data-v-7b719e9c]{display:table-row;background-color:#fff;color:#000}.slottedtable .st-cell[data-v-7b719e9c]{display:table-cell;border-top:1px solid black;border-bottom:1px solid black;padding:8px;text-align:center}.slottedtable .st-footer[data-v-7b719e9c]{display:flex;flex-direction:row;gap:1em;justify-content:flex-end;margin-top:1em;align-items:center}.slottedtable .st-pageselector[data-v-7b719e9c]{display:flex;flex-direction:row;gap:1em;align-items:center}.slottedtable .st-pageselector .st-select[data-v-7b719e9c]{display:inline-block;background-color:#fff;color:#000;border:2px solid black;text-align:center;text-decoration:none;transition:background-color .3s ease,color .3s ease;border-radius:15px;font-size:14px}.slottedtable .st-pagebtns[data-v-7b719e9c]{display:flex;flex-direction:row}.slottedtable .st-pagebtns button[data-v-7b719e9c]{display:inline-block;padding:5px 10px;border:1px solid gray;text-align:center;text-decoration:none;transition:background-color .3s ease,color .3s ease;border-radius:5px;background-color:#fff}.slottedtable .st-pagebtns .st-active[data-v-7b719e9c]{font-weight:700;background-color:green;color:#fff}.slottedtable .st-pointer[data-v-7b719e9c]{cursor:pointer}.slottedtable .st-filtercontainer[data-v-7b719e9c]{display:flex;flex-direction:row;padding-bottom:1em;align-content:center;justify-content:space-between;align-items:center}.slottedtable .st-filteractions[data-v-7b719e9c]{display:flex;flex-direction:row;gap:1em;padding-bottom:1em}.slottedtable .st-activefilter[data-v-7b719e9c]{display:flex;flex-direction:row;gap:.5em;flex-wrap:wrap;align-items:center;margin-bottom:5px}.slottedtable .st-activefilter>button[data-v-7b719e9c]{padding:5px 10px;border:1px solid black;cursor:pointer}.slottedtable .st-searchbutton[data-v-7b719e9c]{margin-left:5px}.slottedtable .st-bulkactions[data-v-7b719e9c]{display:flex;flex-direction:row;align-items:center;align-content:center;flex-wrap:nowrap;gap:1em}
`,document.head.appendChild(N);const K={pleaseWait:"Caricamento",noResults:"Nessun risultato",rowsPerPage:"Righe per pagina:",of:"di",filter:"Filtro",search:"Cerca",activefilters:"Ricerca attiva",bulkActions:"Azioni in blocco",selectAll:"Seleziona tutto",selectCurrentPageElement:"Seleziona tutti gli elementi in questa pagina"},z={pleaseWait:"Loading",noResults:"No results",rowsPerPage:"Rows per page:",of:"of",filter:"Filter",search:"Search",activefilters:"Active search",bulkActions:"Selected",selectAll:"Select all",selectCurrentPageElement:"Select all elements in this page",unselectAll:"Unselect all"},J={pleaseWait:"Chargement",noResults:"Aucun résultat",rowsPerPage:"Lignes par page:",of:"sur",filter:"Filtrer",search:"Rechercher",activefilters:"Recherche active",bulkActions:"Actions en masse",selectAll:"Tout sélectionner",selectCurrentPageElement:"",allSelected:"Sélectionner tous les éléments sur cette page"},Z={pleaseWait:"Laden",noResults:"Keine Ergebnisse",rowsPerPage:"Zeilen pro Seite:",of:"von",filter:"Filter",search:"Suche",activefilters:"Aktive Suche",bulkActions:"Massenaktionen",selectAll:"Alle auswählen",selectCurrentPageElement:"Alle Elemente auf dieser Seite auswählen"},G=d=>{switch(d){case"it":return K;case"en":return z;case"fr":return J;case"de":return Z;default:return z}},t=e.ref({language:"en",trs:{},loading:!0,columns:[],ordering:{sortBy:"id",sortType:"desc"},startIndex:1,endIndex:1,page:1,rowsPerPage:10,totalItems:0,styles:{},filters:[],prevFilters:[],selection:[],selector:!1,selectorColIdentifier:"",allSelected:!1}),Q=d=>{const{styles:g}=t.value;if(!Object.keys(g).length)return"";function m(f){return["container","header","body","footer","row","cell","pageselector","pagebtns","filter","filteractions","activefilter","searchbutton","filterbutton"].includes(f)}return m(d)&&g[d]||""},F=d=>{const g=new Date(d);return!isNaN(g.getTime())&&d===g.toISOString().split("T")[0]?g.getTime():!1},y={getStyle:Q,castToType:d=>isNaN(Number(d))?F(d)?F(d):d:Number(d)},X=["onClick","title"],Y={key:0},ee=["innerHTML"],te=["title","checked","disabled"],le=e.defineComponent({__name:"TableHeader",emits:["update","updateSelection"],setup(d,{emit:g}){const m=g,f=e.computed(()=>t.value.columns),S=e.computed(()=>t.value.selectorColIdentifier),x=e.computed(()=>t.value.trs),v=e.computed(()=>t.value.allSelected),E=e.computed(()=>["st-row","st-header",y.getStyle("row"),y.getStyle("header")]),w=p=>["st-cell",p.sortable?"st-pointer":"",y.getStyle("cell")],I=p=>{if(!p||!p.value||!p.sortable)return;const{sortBy:i,sortType:s}=t.value.ordering;t.value.ordering.sortType=i===p.value&&s==="asc"?"desc":"asc",t.value.ordering.sortBy=p.value,m("update")},B=p=>({width:p.width?`${p.width}px`:"auto"}),k=p=>{const{sortBy:i,sortType:s}=t.value.ordering;return i!==p?"":!s||s==="asc"?"&uarr;":"&darr;"},_=p=>{const i=p.target;if(!i)return;let s=document.querySelectorAll(".st-row-selector");const u=[];s.forEach(h=>{const r=h;r.checked=i.checked,u.push(r.id)}),u.forEach(h=>{i.checked?t.value.selection.indexOf(h)===-1&&t.value.selection.push(h):t.value.selection=t.value.selection.filter(r=>r!==h)}),m("updateSelection")};return(p,i)=>(e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(E.value)},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(f.value,(s,u)=>(e.openBlock(),e.createElementBlock("div",{key:s.value||u,onClick:h=>I(s),class:e.normalizeClass(w(s)),style:e.normalizeStyle(B(s)),title:s.text},[s.value!==S.value?(e.openBlock(),e.createElementBlock("b",Y,[e.createTextVNode(e.toDisplayString(s.text)+" ",1),e.createElementVNode("span",{innerHTML:k(s.value)},null,8,ee)])):(e.openBlock(),e.createElementBlock("input",{key:1,id:"st-select-all",type:"checkbox",title:x.value.selectCurrentPageElement,checked:v.value,onChange:_,disabled:v.value},null,40,te))],14,X))),128))],2))}}),ae=["value"],oe=["onClick"],se={key:1},ne=e.defineComponent({__name:"TableFooter",emits:["update"],setup(d,{emit:g}){const m=g,f=e.computed(()=>[5,10,25,50]),S=e.computed(()=>{const{totalItems:i,rowsPerPage:s,page:u}=t.value;if(!i)return[];const h=Math.ceil(i/s),r=u;if(h<=4)return Array.from({length:h},(T,D)=>D+1);const c=[1];return r>3&&c.push("..."),r>2&&c.push(r-1),r!==1&&r!==h&&c.push(r),r<h-1&&c.push(r+1),r<h-2&&c.push("..."),c.push(h),c}),x=e.computed({get(){return t.value.rowsPerPage},set(i){t.value.rowsPerPage=i}}),v=e.computed(()=>t.value.startIndex),E=e.computed(()=>t.value.endIndex),w=e.computed(()=>t.value.totalItems),I=e.computed(()=>t.value.page),B=async i=>{!Number.isInteger(i)||i<1||(t.value.page=i,m("update",{clearSelected:!0}))},k=e.computed(()=>t.value.trs),_=e.computed(()=>["st-pageselector",y.getStyle("pageselector")]),p=e.computed(()=>["st-pagebtns",y.getStyle("pagebtns")]);return(i,s)=>(e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",{class:e.normalizeClass(_.value)},[e.createTextVNode(e.toDisplayString(k.value.rowsPerPage)+" ",1),e.withDirectives(e.createElementVNode("select",{name:"st-rows-per-page-selector",class:"st-select","onUpdate:modelValue":s[0]||(s[0]=u=>x.value=u),onChange:s[1]||(s[1]=u=>B(1))},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(f.value,u=>(e.openBlock(),e.createElementBlock("option",{key:u,value:u},e.toDisplayString(u),9,ae))),128))],544),[[e.vModelSelect,x.value]])],2),e.createElementVNode("div",null,e.toDisplayString(v.value)+"-"+e.toDisplayString(E.value)+" "+e.toDisplayString(k.value.of)+" "+e.toDisplayString(w.value||0),1),w.value>x.value?(e.openBlock(),e.createElementBlock("div",{key:0,class:e.normalizeClass(p.value)},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(S.value,u=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:u},[typeof u=="number"?(e.openBlock(),e.createElementBlock("button",{key:0,class:e.normalizeClass({"st-active":Number(u)===Number(I.value)}),onClick:h=>B(u)},e.toDisplayString(u),11,oe)):(e.openBlock(),e.createElementBlock("span",se,"  "))],64))),128))],2)):e.createCommentVNode("",!0)],64))}}),re={width:"100",height:"100",viewBox:"0 0 100 100",xmlns:"http://www.w3.org/2000/svg"},ce=e.createElementVNode("circle",{cx:"50",cy:"50",r:"40",stroke:"#007bff","stroke-width":"6",fill:"none","stroke-dasharray":"251.2","stroke-dashoffset":"251.2"},[e.createElementVNode("animate",{attributeName:"stroke-dashoffset",from:"251.2",to:"0",dur:"2s",repeatCount:"indefinite"}),e.createElementVNode("animate",{attributeName:"opacity",from:"1",to:"0",dur:"2s",repeatCount:"indefinite"})],-1),ie={x:"50%",y:"60%","text-anchor":"middle","font-size":"10px",fill:"#007bff"},de=e.defineComponent({__name:"SpinnerItem",props:{text:{type:String,default:""}},setup(d){return(g,m)=>(e.openBlock(),e.createElementBlock("svg",re,[ce,e.createElementVNode("text",ie,e.toDisplayString(d.text),1)]))}}),pe=e.defineComponent({__name:"BulkSelection",emits:["updateSelection"],setup(d,{emit:g}){const m=e.computed(()=>t.value.trs),f=e.computed(()=>["st-bulkactions",y.getStyle("bulkactions")]),S=e.computed(()=>t.value.allSelected?m.value.unselectAll:m.value.selectAll),x=e.computed(()=>{const w=t.value.selection.length;return t.value.allSelected?t.value.totalItems:w}),v=g,E=()=>{t.value.allSelected=!t.value.allSelected,t.value.allSelected===!1&&(t.value.selection=[]),v("updateSelection")};return(w,I)=>(e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(f.value)},[e.createElementVNode("p",null,e.toDisplayString(m.value.bulkActions)+":",1),e.createElementVNode("p",null,e.toDisplayString(x.value),1),e.createElementVNode("button",{onClick:E},e.toDisplayString(S.value),1)],2))}}),ue=["disabled"],me=["data-key"],fe=e.defineComponent({__name:"FilterComponent",emits:["update","updateSelection"],setup(d,{emit:g}){const m=e.computed(()=>t.value.trs),f=e.ref(""),S=e.ref([]),x=g,v=e.computed(()=>["st-filtercontainer",y.getStyle("filter")]),E=e.computed(()=>["st-filteractions",y.getStyle("filteractions")]),w=e.computed(()=>["st-activefilter",y.getStyle("activefilter")]),I=e.computed(()=>["st-searchbutton",y.getStyle("searchbutton")]),B=e.computed(()=>["st-filterbutton",y.getStyle("filterbutton")]),k=e.computed(()=>t.value.filters||[]),_=e.computed(()=>t.value.selector),p=e.computed(()=>Number(t.value.totalItems)),i=r=>{if(!r||r==="")return"";let c=r.trim().toLowerCase();return c=c.normalize("NFD").replace(/[\u0300-\u036f]/g,""),c=c.replace(/[^a-z0-9]/g,"-").trim(),c},s=()=>{const r=t.value.filters||[];if(f.value===""||p.value<=0)return;const c=i(f.value);if(!r||r.length===0){r||(t.value.filters=[]),t.value.filters.push(f.value),S.value.push(c),x("update"),f.value="";return}S.value.indexOf(c)===-1&&(t.value.filters.push(f.value),S.value.push(c),x("update"),f.value="")},u=r=>{const c=r.target,T=c.getAttribute("data-key")||"";S.value=S.value.filter(D=>D!==T),t.value.filters=t.value.filters.filter(D=>D!==c.innerHTML),c.remove(),x("update")},h=()=>x("updateSelection");return(r,c)=>(e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",{class:e.normalizeClass(v.value)},[e.createElementVNode("div",{class:e.normalizeClass(E.value)},[e.createTextVNode(e.toDisplayString(m.value.filter)+" ",1),e.withDirectives(e.createElementVNode("input",{id:"st-text-search",type:"text",onKeyup:e.withKeys(s,["enter"]),"onUpdate:modelValue":c[0]||(c[0]=T=>f.value=T),autocomplete:"on"},null,544),[[e.vModelText,f.value]]),e.createElementVNode("button",{class:e.normalizeClass(I.value),onClick:s,disabled:p.value<=0},e.toDisplayString(m.value.search),11,ue)],2),_.value?(e.openBlock(),e.createBlock(pe,{key:0,onUpdateSelection:h})):e.createCommentVNode("",!0)],2),k.value.length>0?(e.openBlock(),e.createElementBlock("div",{key:0,class:e.normalizeClass(w.value)},[e.createTextVNode(e.toDisplayString(m.value.activefilters)+" ",1),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(k.value,T=>(e.openBlock(),e.createElementBlock("button",{class:e.normalizeClass(B.value),key:i(T),"data-key":i(T),onClick:u},e.toDisplayString(T),11,me))),128))],2)):e.createCommentVNode("",!0)],64))}}),ge={key:1},ye=["onClick"],ke={key:0},he=["id","checked","disabled"],R=((d,g)=>{const m=d.__vccOpts||d;for(const[f,S]of g)m[f]=S;return m})(e.defineComponent({__name:"SlottedTable",props:{headers:{type:Array,default:()=>[],required:!0},selector:{type:Boolean,default:!1},items:{type:Array,default:()=>[]},styles:{type:Object,default:()=>({})},language:{type:String,default:"en"},callBack:{type:Function,default:null}},emits:["updateSelection","rowClick"],setup(d,{expose:g,emit:m}){const f=d,{headers:S,items:x,styles:v,language:E,callBack:w,selector:I}=e.toRefs(f),B=e.ref(!1),k=e.ref([]),_=e.ref([]),p=e.ref(G(E.value)),i=m,s=async l=>{if(!w.value)throw new Error("Callback is not defined or invalid");const a=await w.value({...l});if(a!=null&&a.rows&&a.totalRows)return a.rows.forEach(o=>{o.ST_UID=H(o)}),{rows:a.rows,totalItems:a.totalRows};throw new Error("Callback response is invalid or errored")},u=async()=>{const{page:l,rowsPerPage:a,ordering:o,filters:n,prevFilters:b}=t.value,{sortBy:C,sortType:P}=o,$={page:l,rowsPerPage:a,sortBy:C,sortType:P};n.length>0&&($.filters=n,(n.length!==b.length||n.join("|")!==b.join("|"))&&($.page=1,t.value.page=1),t.value.prevFilters=[...n]);const W=await s($);k.value=W.rows,t.value.totalItems=W.totalItems},h=()=>{const{sortBy:l,sortType:a}=t.value.ordering;_.value.sort((o,n)=>{const b=y.castToType(o[l]),C=y.castToType(n[l]);return b<C?a==="asc"?-1:1:b>C?a==="asc"?1:-1:0})},r=()=>{const l=t.value.filters;if(l.length===0){k.value=_.value,t.value.totalItems=k.value.length;return}let a=_.value.filter(o=>{const n=Object.values(o).join("|").toLowerCase();let b=0;for(const C of l){const P=n.includes(C.toLowerCase());b+=P?1:0}return b===l.length});k.value=a,t.value.totalItems=k.value.length},c=()=>{const{page:l,rowsPerPage:a}=t.value;k.value=k.value.slice((l-1)*a,l*a)},T=()=>{const{page:l,rowsPerPage:a,totalItems:o}=t.value;t.value.startIndex=(l-1)*a+1,t.value.endIndex=Math.min(l*a,o)},D=l=>({width:l.width?`${l.width}px`:"auto"}),U=e.computed(()=>t.value.loading),be=e.computed(()=>t.value.columns),Se=e.computed(()=>t.value.selectorColIdentifier),xe=e.computed(()=>t.value.allSelected),we=e.computed(()=>["slottedtable",y.getStyle("container")]),L=e.computed(()=>["st-body",y.getStyle("body")]),M=e.computed(()=>["st-row",y.getStyle("row")]),O=e.computed(()=>["st-cell",y.getStyle("cell")]),_e=e.computed(()=>["st-footer",y.getStyle("footer")]),j=()=>{const l=document.querySelectorAll(".st-row-selector:checked"),a=document.querySelectorAll(".st-row-selector");return l.length===a.length},q=async()=>{const{selection:l,allSelected:a,ordering:o}=t.value;if(a)if(B.value){const C={sortBy:o.sortBy,sortType:o.sortType,page:1,rowsPerPage:"all"};return(await s(C)).rows}else return _.value;const n=k.value.filter(C=>l.indexOf(C.ST_UID)!==-1),b=[];return n.forEach(C=>{const P={...C};delete P.ST_UID,b.push(P)}),b},V=async()=>{const l=await q();i("updateSelection",{...l})},Ce=l=>{const a={...l};delete a.ST_UID,i("rowClick",a)},Be=l=>{const{selection:a}=t.value,o=document.querySelector("#st-select-all"),n=l.target;if(n){if(!n.checked){t.value.selection=a.filter(b=>b!==n.id),j()||(o.checked=!1,t.value.allSelected=!1);return}t.value.selection.push(n.id),j()&&(o.checked=!0,t.value.allSelected=!1),V()}},ve=l=>t.value.allSelected?!0:t.value.selection.indexOf(l)!==-1,H=l=>{const a=JSON.stringify(l,Object.keys(l).sort());let o=Date.now()-Math.random();for(let b=0;b<a.length;b++)o=o*33^a.charCodeAt(b);return(o>>>0).toString(16)};e.onMounted(async()=>{t.value.selectorColIdentifier=`${Date.now()}-${Math.random().toString(36)}`,t.value.trs=p,t.value.language=E.value,I.value&&S.value.unshift({text:"",value:t.value.selectorColIdentifier,sortable:!1}),t.value.columns=S.value,t.value.styles=v.value,t.value.selector=I.value,B.value=!!w.value,B.value||(x.value.forEach(l=>{l.ST_UID=H(l)}),_.value=x.value,t.value.totalItems=_.value.length),await A()});const A=async(l=null)=>{if(t.value.loading=!0,B.value?await u():(h(),r(),c()),T(),l!=null&&l.clearSelected){const a=document.querySelector("#st-select-all");a&&(a.checked=!1),t.value.selection=[]}t.value.loading=!1};return g({reloadTable:A,getSelection:async()=>await q()}),(l,a)=>(e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(we.value)},[e.createVNode(fe,{onUpdate:A,onUpdateSelection:V}),U.value||!k.value.length?(e.openBlock(),e.createElementBlock("div",{key:0,class:e.normalizeClass(L.value)},[e.createElementVNode("div",{class:e.normalizeClass(M.value)},[e.createElementVNode("div",{class:e.normalizeClass(O.value)},[U.value?(e.openBlock(),e.createBlock(de,{key:0,text:p.value.pleaseWait},null,8,["text"])):(e.openBlock(),e.createElementBlock("span",ge,e.toDisplayString(p.value.noResults),1))],2)],2)],2)):(e.openBlock(),e.createElementBlock("div",{key:1,class:e.normalizeClass(L.value)},[e.createVNode(le,{onUpdate:A,onUpdateSelection:V}),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(k.value,o=>(e.openBlock(),e.createElementBlock("div",{key:o.ST_UID,class:e.normalizeClass(M.value)},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(be.value,n=>(e.openBlock(),e.createElementBlock("div",{key:`${o.ST_UID}-${n.value}`,class:e.normalizeClass(O.value),style:e.normalizeStyle(D(n)),onClick:b=>Ce(o)},[n.value===Se.value?(e.openBlock(),e.createElementBlock("div",ke,[e.createElementVNode("input",{id:o.ST_UID,class:"st-row-selector",type:"checkbox",checked:ve(o.ST_UID),onChange:Be,disabled:xe.value},null,40,he)])):e.renderSlot(l.$slots,n.value,{key:1,column:n.value,cellData:o[n.value]||n.empty,data:o},()=>[e.renderSlot(l.$slots,"default",{column:n.value,cellData:o[n.value]||n.empty,data:o},void 0,!0)],!0)],14,ye))),128))],2))),128))],2)),e.createElementVNode("div",{class:e.normalizeClass(_e.value)},[e.createVNode(ne,{onUpdate:A})],2)],2))}}),[["__scopeId","data-v-7b719e9c"]]);return typeof window<"u"&&window.Vue&&window.Vue.createApp({}).component("SlottedTable",R),R});
